"use strict";var J=Object.defineProperty;var o=(e,s)=>J(e,"name",{value:s,configurable:!0});var I=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),h=require("node:path"),R=require("node:url"),j=require("get-tsconfig"),W=require("node:fs"),S=require("./index-CoHsQGpm.cjs"),U=require("./client-D6NvIMSC.cjs");const y=Object.create(null);y[".js"]=[".ts",".tsx",".js",".jsx"],y[".jsx"]=[".tsx",".ts",".jsx",".js"],y[".cjs"]=[".cts"],y[".mjs"]=[".mts"];const w=o(e=>{const[s,t]=e.split("?"),a=h.extname(s),i=y[a];if(i){const l=s.slice(0,-a.length);return i.map(n=>l+n+(t?`?${t}`:""))}},"resolveTsPath"),k=o(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),$=o(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),Q=o(e=>$(e)||h.isAbsolute(e),"isUnixPath"),B=o(e=>{if(Q(e))return!0;const s=k(e);return s&&s!=="node"},"requestAcceptsQuery"),L="file://",A=/\.([cm]?ts|[tj]sx)($|\?)/,z=/\.json($|\?)/,G=/\/(?:$|\?)/,H=/^(?:@[^/]+\/)?[^/]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const F=o(e=>{let s=null;if(e){const t=h.resolve(e);s={path:t,config:j.parseTsconfig(t)}}else{try{s=j.getTsconfig()}catch{}if(!s)return}exports.fileMatcher=j.createFilesMatcher(s),exports.tsconfigPathsMatcher=j.createPathsMatcher(s),exports.allowJs=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),T=o(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),X=`${h.sep}node_modules${h.sep}`,N=o(e=>{if(!e.startsWith("data:text/javascript,"))return e;const s=e.indexOf("?");if(s===-1)return e;const t=new URLSearchParams(e.slice(s+1));let a=t.get("filePath");if(a){const i=t.get("namespace");i&&(a+=`?namespace=${encodeURIComponent(i)}`),d._cache[a]=d._cache[e],delete d._cache[e],e=a}return e},"interopCjsExports"),E=o((e,s,t)=>{if(!(t?.filename&&A.test(t.filename))&&!exports.allowJs)return;const a=w(s);if(a)for(const i of a)try{return e(i)}catch(l){const{code:n}=l;if(n!=="MODULE_NOT_FOUND"&&n!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw l}},"resolveTsFilename"),K=[".ts",".tsx",".jsx"],_=o((e,s)=>{for(const t of K)try{return e(s+t)}catch{}},"tryExtensions"),V=o((e,s)=>(t,a,i,l)=>{const n=o(c=>e(c,a,i,l),"resolve");t=N(t);const[m,g]=t.split("?"),u=new URLSearchParams(g);if(a?.filename){const r=new URLSearchParams(a.filename.split("?")[1]).get("namespace");r&&u.append("namespace",r)}if((u.get("namespace")??void 0)!==s)return n(t);const f=T(u);if(t=m,t.startsWith(L)&&(t=R.fileURLToPath(t)),exports.tsconfigPathsMatcher&&!$(t)&&!a?.filename?.includes(X)){const c=exports.tsconfigPathsMatcher(t);for(const r of c){const p=E(n,r,a);if(p)return p+f;try{return n(r)+f}catch{const x=_(n,r)||_(n,`${t}${h.sep}index`);if(x)return x+f}}}const P=E(n,t,a);if(P)return P+f;try{const c=n(t);return c+(h.isAbsolute(c)?f:"")}catch(c){const r=c;if(r.code==="MODULE_NOT_FOUND"&&typeof r.path=="string"&&r.path.endsWith("package.json")){const x=r.message.match(/^Cannot find module '([^']+)'$/);if(x){const M=x[1],v=E(n,M,a);if(v)return v+f}const O=r.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(O){const M=O[1],v=E(n,M,a);if(v)return v+f}}const p=_(n,t)||_(n,`${t}${h.sep}index`);if(p)return p+f;throw r}},"createResolveFilename"),Y=`
//# sourceMappingURL=data:application/json;base64,`,C=o(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),b=o(({code:e,map:s})=>e+Y+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),Z=[".cts",".mts",".ts",".tsx",".jsx"],q=[".js",".cjs",".mjs"],ee=o((e,s)=>{const t=Object.assign(Object.create(null),e),a=t[".js"],i=o((l,n)=>{const[m,g]=n.split("?");if((new URLSearchParams(g).get("namespace")??void 0)!==s)return a(l,m);U.parent?.send&&U.parent.send({type:"dependency",path:m});const f=Z.some(r=>m.endsWith(r)),P=q.some(r=>m.endsWith(r));if(!f&&!P)return a(l,m);let c=W.readFileSync(m,"utf8");if(m.endsWith(".cjs")){const r=S.transformDynamicImport(n,c);r&&(c=C()?b(r):r.code)}else if(f||S.isESM(c)){const r=S.transformSync(c,n,{tsconfigRaw:exports.fileMatcher?.(m)});c=C()?b(r):r.code}l._compile(c,m)},"transformer");return t[".js"]=i,[".ts",".tsx",".jsx"].forEach(l=>{const n=Object.getOwnPropertyDescriptor(t,l);Object.defineProperty(t,l,{value:i,enumerable:n?.enumerable||!s})}),Object.defineProperty(t,".mjs",{value:i,enumerable:!1}),t},"createExtensions"),D=o((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof s=="string"&&s.startsWith("file://")||s instanceof URL)&&(s=R.fileURLToPath(s)),h.resolve(h.dirname(s),e)},"resolveContext"),se=o(e=>{const{sourceMapsEnabled:s}=process,{_extensions:t,_resolveFilename:a}=d;F(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const i=V(a,e?.namespace);d._resolveFilename=i;const l=ee(d._extensions,e?.namespace);d._extensions=l;const n=o(()=>{s===!1&&process.setSourceMapsEnabled(!1),d._extensions=t,d._resolveFilename=a},"unregister");if(e?.namespace){const m=o((u,f)=>{const P=D(u,f),[c,r]=P.split("?"),p=new URLSearchParams(r);return e.namespace&&p.set("namespace",e.namespace),I.require(c+T(p))},"scopedRequire");n.require=m;const g=o((u,f,P)=>{const c=D(u,f),[r,p]=c.split("?"),x=new URLSearchParams(p);return e.namespace&&x.set("namespace",e.namespace),i(r+T(x),module,!1,P)},"scopedResolve");n.resolve=g,n.unregister=n}return n},"register");exports.fileUrlPrefix=L,exports.inlineSourceMap=b,exports.interopCjsExports=N,exports.isBarePackageName=H,exports.isDirectoryPattern=G,exports.isJsonPattern=z,exports.loadTsconfig=F,exports.register=se,exports.requestAcceptsQuery=B,exports.resolveTsPath=w,exports.tsExtensionsPattern=A;
